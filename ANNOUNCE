Cosmetic changes, still nearly untested.
