Batch adding of keys and diagnostic dump added.

GPL preamble added to source to make it more clear.
Additional more minor updates.
